
DROP TABLE IF EXISTS `srampos_memeber_discount_card`;CREATE TABLE `srampos_member_discounts` (
  `id` bigint(10) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) NOT NULL,
  `created_dt` datetime NOT NULL,
  `updated_dt` datetime NOT NULL,
  `status` tinyint(4) NOT NULL,
  `apply_all` tinyint(4) NOT NULL,
  `from_date` datetime NOT NULL,
  `to_date` datetime NOT NULL,
  `from_time` time NOT NULL,
  `to_time` time NOT NULL,
  `week_days` varchar(200) NOT NULL,
  `days_check` tinyint(4) NOT NULL,
  `discount` decimal(12,2) DEFAULT NULL,
  `discount_type` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=latin1;

CREATE TABLE `srampos_memberdiscountcards` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `card_details_id` int(11) NOT NULL,
  `created_store` int(11) DEFAULT NULL,
  `store_id` int(11) DEFAULT NULL,
  `card_no` varchar(200) NOT NULL,
  `created_on` datetime NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=latin1;

CREATE TABLE `srampos_memberdiscountcards_blocked` (
  `s_no` int(11) NOT NULL AUTO_INCREMENT,
  `id` int(11) NOT NULL,
  `card_details_id` int(11) NOT NULL,
  `card_id` int(11) NOT NULL,
  `customer_id` int(11) DEFAULT NULL,
  `status` tinyint(4) NOT NULL,
  `created_on` datetime NOT NULL,
  `store_id` int(11) NOT NULL,
  PRIMARY KEY (`s_no`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE `srampos_memberdisountcard_issued` (
  `s_no` int(11) NOT NULL AUTO_INCREMENT,
  `id` int(11) NOT NULL,
  `card_details_id` int(11) NOT NULL,
  `card_id` int(11) NOT NULL,
  `customer_id` int(11) DEFAULT NULL,
  `status` tinyint(4) NOT NULL,
  `created_on` datetime NOT NULL,
  `store_id` int(11) NOT NULL,
  PRIMARY KEY (`s_no`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;


CREATE TABLE `srampos_memeber_discount_card_details` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `store_id` int(11) DEFAULT NULL,
  `code` varchar(200) DEFAULT NULL,
  `name` varchar(200) DEFAULT NULL,
  `prefix` varchar(255) DEFAULT NULL,
  `serial_no` varchar(255) DEFAULT NULL,
  `from_date` date DEFAULT NULL,
  `to_date` date DEFAULT NULL,
  `no_of_vouchers` int(11) DEFAULT NULL,
  `min_transactions` int(11) DEFAULT NULL,
  `status` int(11) DEFAULT NULL,
  `discount_val` int(11) DEFAULT NULL,
  `valid_req` varchar(50) NOT NULL,
  `member_discount_id` int(11) NOT NULL,
  `selling_price` decimal(12,2) NOT NULL DEFAULT '0.00',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=latin1;


CREATE TABLE `srampos_memeberdiscountcard_status` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `card_id` int(11) NOT NULL,
  `status` tinyint(4) NOT NULL COMMENT '1-created,2-issued,4-blocked',
  `issued_on` datetime DEFAULT NULL,
  `blocked_on` datetime DEFAULT NULL,
  `store_id` int(11) DEFAULT NULL,
  `discount_card_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=latin1;
ALTER TABLE `srampos_memberdisountcard_issued` ADD `seeling_price` DECIMAL(12,2) NOT NULL DEFAULT '0.00' AFTER `store_id`, ADD `valid_upto` DATE NOT NULL AFTER `seeling_price`, ADD `discount` DECIMAL(12,2) NULL DEFAULT '0.00' AFTER `valid_upto`, ADD `discounttype` VARCHAR(50) NOT NULL AFTER `discount`;


ALTER TABLE `srampos_memberdisountcard_issued` CHANGE `card_details_id` `member_discount_id` INT(11) NOT NULL;
ALTER TABLE `srampos_memberdisountcard_issued` CHANGE `seeling_price` `selling_price` DECIMAL(12,2) NOT NULL DEFAULT '0.00';
ALTER TABLE `srampos_memberdisountcard_issued` ADD `card_details_id` INT NOT NULL AFTER `discounttype`;